# ===============================================
# 1. Base Image
# ===============================================
# Java 21 JRE(실행 환경) 이미지를 사용합니다.
# 기존 ci.yml에서 JDK 21을 사용하고 있습니다.
FROM eclipse-temurin:21-jre-jammy

# ===============================================
# 2. Argument & Copy
# ===============================================
# GitHub Actions의 빌드 잡에서 생성된 JAR 파일의 경로를 인자로 받습니다.
# 기본값은 build/libs/*.jar 입니다.
ARG JAR_FILE=build/libs/*.jar

# 호스트(GitHub Actions 러너)의 JAR 파일을
# 컨테이너(이미지) 내부의 'app.jar'라는 이름으로 복사합니다.
COPY ${JAR_FILE} app.jar

# ===============================================
# 3. Expose Port
# ===============================================
# 우리 Spring Boot 서버는 8080 포트를 사용합니다.
EXPOSE 8080

# ===============================================
# 4. Entrypoint
# ===============================================
# 컨테이너가 시작될 때 실행할 명령어입니다.
# 기존 ci.yml 스크립트에서 사용한 옵션을 포함합니다.
ENTRYPOINT ["java", "-Djava.net.preferIPv4Stack=true", "-jar", "/app.jar"]